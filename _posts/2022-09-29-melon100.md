---
title:  "[멋사 AI 7기] 멜론 크롤링 해보기(진행중)"
categories: likelion
tag: [TIL]
toc: true
author_profile: false
sidebar:
    nav: "docs"
search: true
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>



```python
import pandas as pd
import numpy as np
import requests
```


```python
url = "https://www.melon.com/chart/index.htm"
```


```python
# 로봇으로 인식하는 것 같음
# pd.read_html(url)
```


```python
response = requests.get(url, headers={"user-agent": "Mozilla/5.0"})
response
```

<pre>
<Response [200]>
</pre>

```python
response.text
```

```python
table = pd.read_html(response.text)
```

```python
temp = table[0]
temp.head()
```

<pre>
   Unnamed: 0  순위      순위등락  앨범이미지 곡 상세가기  \
0         NaN  1위  순위 동일  0    NaN    곡정보   
1         NaN  2위  순위 동일  0    NaN    곡정보   
2         NaN  3위  순위 동일  0    NaN    곡정보   
3         NaN  4위  순위 동일  0    NaN    곡정보   
4         NaN  5위  순위 동일  0    NaN    곡정보   

                                      곡정보  \
0  새삥 (Prod. ZICO) (Feat. 호미들)  지코 (ZICO)   
1                   After LIKE  IVE (아이브)   
2                     Attention  NewJeans   
3                    Shut Down  BLACKPINK   
4                   Pink Venom  BLACKPINK   

                                     앨범          좋아요  듣기  담기    다운     뮤비  
0  스트릿 맨 파이터(SMF) Original Vol.3 (계급미션)  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
1                            After LIKE  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
2           NewJeans 1st EP 'New Jeans'  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
3                             BORN PINK  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
4                             BORN PINK  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
</pre>

```python
temp.tail()
```

<pre>
    Unnamed: 0    순위      순위등락  앨범이미지 곡 상세가기  \
95         NaN   96위  단계 상승  1    NaN    곡정보   
96         NaN   97위  단계 하락  1    NaN    곡정보   
97         NaN   98위  순위 동일  0    NaN    곡정보   
98         NaN   99위  순위 동일  0    NaN    곡정보   
99         NaN  100위     순위 진입    NaN    곡정보   

                                          곡정보  \
95                                   HOT  세븐틴   
96  OHAYO MY NIGHT  디핵 (D-Hack), PATEKO (파테코)   
97                    윤슬 (Gold Dust)  NCT 127   
98                            그중에 그대를 만나  김호중   
99                       언제나 사랑해  케이시 (Kassy)   

                                    앨범          좋아요  듣기  담기    다운     뮤비  
95  SEVENTEEN 4th Album 'Face the Sun'  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
96                      OHAYO MY NIGHT  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
97      질주 (2 Baddies) - The 4th Album  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
98                          그중에 그대를 만나  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
99                조영수 리메이크 프로젝트 Part.2  좋아요  총건수  0  듣기  담기  다운로드  뮤직비디오  
</pre>

```python
# 'Unnamed: 0' : 선택버튼 무의미한 컬럼 
# ['곡 상세가기', '듣기', '담기', '다운', '뮤비'] : 추가 기능

# '순위등락' : 전처리 해서 사용가능
# '좋아요' : 모두 0으로 나오는 데 홈페이지상으론 수치가 나옴, 추가 처리 필요
# '앨범이미지' : NaN으로 받아와짐, 추가 처리 필요
# ["순위", "순위등락", "곡정보", "앨범"] : 사용
temp.columns
```

<pre>
Index(['Unnamed: 0', '순위', '순위등락', '앨범이미지', '곡 상세가기', '곡정보', '앨범', '좋아요', '듣기',
       '담기', '다운', '뮤비'],
      dtype='object')
</pre>

```python
df = temp[["순위", "순위등락", "곡정보", "앨범"]]
df.head()
```

<pre>
   순위      순위등락                                     곡정보  \
0  1위  순위 동일  0  새삥 (Prod. ZICO) (Feat. 호미들)  지코 (ZICO)   
1  2위  순위 동일  0                   After LIKE  IVE (아이브)   
2  3위  순위 동일  0                     Attention  NewJeans   
3  4위  순위 동일  0                    Shut Down  BLACKPINK   
4  5위  순위 동일  0                   Pink Venom  BLACKPINK   

                                     앨범  
0  스트릿 맨 파이터(SMF) Original Vol.3 (계급미션)  
1                            After LIKE  
2           NewJeans 1st EP 'New Jeans'  
3                             BORN PINK  
4                             BORN PINK  
</pre>

```python
from bs4 import BeautifulSoup as bs
html = bs(response.text)
html
```

```python
#lst50 > td:nth-child(8) > div > button > span.cnt > span
# 이것도 0으로 뜸, 고민해봐야겠다.
html.select("span.cnt")[9:15]
```

<pre>
[<span class="cnt">
 <span class="none">총건수</span>
 												0
 											</span>, <span class="cnt">
 <span class="none">총건수</span>
 												0
 											</span>, <span class="cnt">
 <span class="none">총건수</span>
 												0
 											</span>, <span class="cnt">
 <span class="none">총건수</span>
 												0
 											</span>, <span class="cnt">
 <span class="none">총건수</span>
 												0
 											</span>, <span class="cnt">
 <span class="none">총건수</span>
 												0
 											</span>]
</pre>

```python
html.select("span.cnt span")[9:15]
```

<pre>
[<span class="none">총건수</span>,
 <span class="none">총건수</span>,
 <span class="none">총건수</span>,
 <span class="none">총건수</span>,
 <span class="none">총건수</span>,
 <span class="none">총건수</span>]
</pre>